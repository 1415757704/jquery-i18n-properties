(function(h){function v(a){a.debug&&(f("callbackIfComplete()"),f("totalFiles: "+a.totalFiles),f("filesLoaded: "+a.filesLoaded));a.async&&a.filesLoaded===a.totalFiles&&a.callback&&a.callback()}function n(a,d){d.debug&&f("loadAndParseFiles");null!==a&&0<a.length?w(a[0],d,function(){a.shift();n(a,d)}):v(d)}function w(a,d,m){d.debug&&(f("loadAndParseFile('"+a+"')"),f("totalFiles: "+d.totalFiles),f("filesLoaded: "+d.filesLoaded));null!==a&&"undefined"!==typeof a&&h.ajax({url:a,async:d.async,cache:d.cache,
dataType:"text",success:function(e,b){d.debug&&(f("Succeeded in downloading "+a+"."),f(e));x(e,d);m()},error:function(e,b,c){d.debug&&f("Failed to download or parse "+a+". errorThrown: "+c);404===e.status&&--d.totalFiles;m()}})}function x(a,d){for(var m="",e=a.split(/\n/),b=/(\{\d+})/g,c=/\{(\d+)}/g,k=/(\\u.{4})/ig,f=0,n=e.length;f<n;f++){var l=e[f],l=l.trim();if(0<l.length&&"#"!=l.match("^#")){var p=l.split("=");if(0<p.length){for(var l=decodeURI(p[0]).trim(),g=1==p.length?"":p[1];-1!=g.search(/\\$/);)g=
g.substring(0,g.length-1),g+=e[++f].trimRight();for(var q=2;q<p.length;q++)g+="="+p[q];g=g.trim();if("map"==d.mode||"both"==d.mode)(p=g.match(k))&&p.forEach(function(a){g=g.replace(a,y(a))}),d.namespace?h.i18n.map[d.namespace][l]=g:h.i18n.map[l]=g;if("vars"==d.mode||"both"==d.mode)if(g=g.replace(/"/g,'\\"'),z(l),b.test(g)){var u=!0,r="",t=[];g.split(b).forEach(function(a){!b.test(a)||0!==t.length&&-1!=t.indexOf(a)||(u||(r+=","),r+=a.replace(c,"v$1"),t.push(a),u=!1)});m+=l+"=function("+r+"){";l='"'+
g.replace(c,'"+v$1+"')+'"';m+="return "+l+";};"}else m+=l+'="'+g+'";'}}}eval(m);d.filesLoaded+=1}function z(a){if(/\./.test(a)){var d="";a=a.split(/\./);for(var m=0,e=a.length;m<e;m++){var b=a[m];0<m&&(d+=".");d+=b;eval("typeof "+d+' == "undefined"')&&eval(d+"={};")}}}function y(a){var d=[];a=parseInt(a.substr(2),16);0<=a&&a<Math.pow(2,16)&&d.push(a);return d.reduce(function(a,d){return a+String.fromCharCode(d)},"")}h.i18n={};h.i18n.map={};var f=function(a){window.console&&console.log("i18n::"+a)};
h.i18n.properties=function(a){a=h.extend({name:"Messages",language:"",path:"",namespace:null,mode:"vars",cache:!1,debug:!1,encoding:"UTF-8",async:!1,callback:null},a);a.namespace&&"string"==typeof a.namespace&&(a.namespace.match(/^[a-z]*$/)?h.i18n.map[a.namespace]={}:(f("Namespaces can only be lower case letters, a - z"),a.namespace=null));a.path.match(/\/$/)||(a.path+="/");a.language=this.normaliseLanguageCode(a.language);var d=a.name&&a.name.constructor===Array?a.name:[a.name];a.totalFiles=2*d.length+
(5<=a.language.length?d.length:0);a.debug&&f("totalFiles: "+a.totalFiles);a.filesLoaded=0;d.forEach(function(d){var e=a.path+d+".properties";var b=a.language.substring(0,2);b=a.path+d+"_"+b+".properties";if(5<=a.language.length){var c=a.language.substring(0,5);d=a.path+d+"_"+c+".properties";e=[e,b,d]}else e=[e,b];n(e,a)});a.callback&&!a.async&&a.callback()};h.i18n.prop=function(a){var d=[].slice.call(arguments);if(2==d.length)if(h.isArray(d[1]))var f=d[1];else if("object"===typeof d[1]){var e=d[1].namespace;
var b=d[1].replacements;d.splice(-1,1);b&&Array.prototype.push.apply(d,b)}b=e?h.i18n.map[e][a]:h.i18n.map[a];if(null===b)return"["+(e?e+"#"+a:a)+"]";var c;if("string"==typeof b){for(c=0;-1!=(c=b.indexOf("\\",c));)b="t"==b.charAt(c+1)?b.substring(0,c)+"\t"+b.substring(c++ +2):"r"==b.charAt(c+1)?b.substring(0,c)+"\r"+b.substring(c++ +2):"n"==b.charAt(c+1)?b.substring(0,c)+"\n"+b.substring(c++ +2):"f"==b.charAt(c+1)?b.substring(0,c)+"\f"+b.substring(c++ +2):"\\"==b.charAt(c+1)?b.substring(0,c)+"\\"+
b.substring(c++ +2):b.substring(0,c)+b.substring(c+1);var k=[];for(c=0;c<b.length;)if("'"==b.charAt(c))if(c==b.length-1)b=b.substring(0,c);else if("'"==b.charAt(c+1))b=b.substring(0,c)+b.substring(++c);else{for(e=c+2;-1!=(e=b.indexOf("'",e));)if(e==b.length-1||"'"!=b.charAt(e+1)){b=b.substring(0,c)+b.substring(c+1,e)+b.substring(e+1);c=e-1;break}else b=b.substring(0,e)+b.substring(++e);-1==e&&(b=b.substring(0,c)+b.substring(c+1))}else if("{"==b.charAt(c))if(e=b.indexOf("}",c+1),-1==e)c++;else{var n=
parseInt(b.substring(c+1,e));!isNaN(n)&&0<=n?(c=b.substring(0,c),""!==c&&k.push(c),k.push(n),c=0,b=b.substring(e+1)):c=e+1}else c++;""!==b&&k.push(b);b=k;h.i18n.map[a]=k}if(0===b.length)return"";if(1==b.length&&"string"==typeof b[0])return b[0];k="";c=0;for(e=b.length;c<e;c++)k="string"==typeof b[c]?k+b[c]:f&&b[c]<f.length?k+f[b[c]]:!f&&b[c]+1<d.length?k+d[b[c]+1]:k+("{"+b[c]+"}");return k};h.i18n.normaliseLanguageCode=function(a){if(!a||2>a.length)a=navigator.languages&&0<navigator.languages.length?
navigator.languages[0]:navigator.language||navigator.userLanguage||"en";a=a.toLowerCase();a=a.replace(/-/,"_");3<a.length&&(a=a.substring(0,3)+a.substring(3).toUpperCase());return a}})(jQuery);
